# Unbounce API

Browser and node module for making API requests against [Unbounce API](https://api.unbounce.com).

**Please note: This module uses [Popsicle](https://github.com/blakeembrey/popsicle) to make API requests. Promises must be supported or polyfilled on all target environments.**

## Installation

```
npm install unbounce-api --save
bower install unbounce-api --save
```

## Usage

### Node

```javascript
var UnbounceApi = require('unbounce-api');

var client = new UnbounceApi();
```

### Browsers

```html
<script src="unbounce-api/index.js">

<script>
  var client = new window.UnbounceApi();
</script>
```

### Authentication

#### OAuth 2.0

This API supports authentication with [OAuth 2.0](https://github.com/mulesoft/js-client-oauth2). Initialize the `OAuth2` instance with the application client id, client secret and a redirect uri to authenticate with users.

```js
var auth = new UnbounceApi.OAuth2({
  clientId:     '123',
  clientSecret: 'abc',
  redirectUri:  'http://example.com/auth/callback'
});
```

**All `getToken()` calls are asynchronous and return promise objects which resolve to an access token instance.**

##### [Authorization Code Grant](https://github.com/mulesoft/js-client-oauth2#authorization-code-grant)

1. Redirect user to `auth.code.getUri()`.
2. Parse response uri and get an access token instance using `auth.code.getToken(uri)`.

##### Access Tokens

Access token instances can be manually re-created. This is critical for access token reuse, such as saving credentials to a database for reusing later in the codebase.

```js
var token = auth.createToken('access token', 'refresh token');
```

An access token instance (manually created or automatically generated by a `getToken()` method) can be passed into any API request. This will sign the API request with the current users access token credentials.

```js
// Existing API client instance.
client.resource('/').get(null, {
  user: token
});

// New API client instance.
var client = new UnbounceApi({
  user: token
});
```

### Options

You can set options when you initialize a client or at any time with the `options` property. You may also override options for a single request by passing an object as the second argument of any request method. For example:

```javascript
var client = new UnbounceApi({ ... });

client.options = { ... };

client.resource('/').get(null, {
  baseUri: 'http://example.com',
  headers: {
    'Content-Type': 'application/json'
  }
});
```

#### Base URI

You can override the base URI by setting the `baseUri` property, or initializing a client with a base URI. For example:

```javascript
new UnbounceApi({
  baseUri: 'https://example.com'
});
```

#### Base URI Parameters

If the base URI has parameters inline, you can set them by updating the `baseUriParameters` property. For example:

```javascript
client.options.baseUriParameters.version = 'v0.4';
```

### Resources

All methods return a HTTP request instance of [Popsicle](https://github.com/blakeembrey/popsicle), which allows the use of promises (and streaming in node).

#### resources

Global API meta-information.

```js
var resource = client.resources;
```

##### GET

Retrieve the global API meta-information.

```js
resource.get().then(function (res) { ... });
```

#### resources.accounts

The accounts collection is the entry point to the rest of the Unbounce API.
Your API key will give you access to all of the clients owned by your primary account.

```js
var resource = client.resources.accounts;
```

##### GET

Retrieve the accounts collection.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.accounts.accountId(account_id)

* **account_id** _string_

Unbounce pages belong to clients which, in turn, belong to accounts.
This API exposes a single Unbounce Account to you.

```js
var resource = client.resources.accounts.accountId(account_id);
```

##### GET

Retrieve the details of a single account.

```js
resource.get().then(function (res) { ... });
```

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.accounts.accountId(account_id).subAccounts

API _Sub Accounts_ are Unbounce _Clients_

```js
var resource = client.resources.accounts.accountId(account_id).subAccounts;
```

##### GET

Retrieve all sub-accounts for the specified account.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.accounts.accountId(account_id).pages

Pages.

```js
var resource = client.resources.accounts.accountId(account_id).pages;
```

##### GET

Retrieve a list of all pages for the specified account.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.subAccounts.subAccountId(sub_account_id)

* **sub_account_id** _string_

Unbounce users can use sub-accounts to manage multiple projects or clients.
Each sub-account has it's own collection of pages, domains and other objects.
For interactive applications, you'd often want to allow users to select a particular sub-account to work with.

```js
var resource = client.resources.subAccounts.subAccountId(sub_account_id);
```

##### GET

Retrieve the details of a single sub-account.

```js
resource.get().then(function (res) { ... });
```

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.subAccounts.subAccountId(sub_account_id).domains

Custom domains.

```js
var resource = client.resources.subAccounts.subAccountId(sub_account_id).domains;
```

##### GET

Retrieve a list of all custom domains belonging to a given sub-account.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.subAccounts.subAccountId(sub_account_id).leads

The leads collection provides access to all of the leads for a sub-account.

```js
var resource = client.resources.subAccounts.subAccountId(sub_account_id).leads;
```

##### GET

Retrieve a list of all leads for a given sub-account.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.subAccounts.subAccountId(sub_account_id).pageGroups

Pages may optionally be organized into groups.

```js
var resource = client.resources.subAccounts.subAccountId(sub_account_id).pageGroups;
```

##### GET

Retrieve a list of all page groups for a given sub-account.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.subAccounts.subAccountId(sub_account_id).pages

Pages.

```js
var resource = client.resources.subAccounts.subAccountId(sub_account_id).pages;
```

##### GET

Retrieve a list of all pages for a given sub-account.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.domains.domainId(domain_id)

* **domain_id** _string_

Customers can register custom domains with Unbounce, then publish pages to those domains.

```js
var resource = client.resources.domains.domainId(domain_id);
```

##### GET

Retrieve a custom domain that has been registered with Unbounce.

```js
resource.get().then(function (res) { ... });
```

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.domains.domainId(domain_id).pages

Pages.

```js
var resource = client.resources.domains.domainId(domain_id).pages;
```

##### GET

Retrieve a list of all pages based on the domain.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.pages

Access all pages for the authenticated principal.
An authenticated principal is either an API Key, or an OAuth client.
We provide this top-level resource specifically for OAuth clients.
Any Unbounce customer can be invited to author or view a page on a different client than their own.
The legacy Pages resource we provide doesn't allow for accessing these external pages.
This top-level resource allows you to additionally filter pages based on the specified role.

```js
var resource = client.resources.pages;
```

##### GET

Retrieve a list of all pages.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

* **with_stats** _boolean_

When true, include page stats for the collection.

* **role** _string, one of (viewer, author), default: viewer_

Restricts the scope of the returned pages.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.pages.pageId(page_id)

* **page_id** _string_

Page.

```js
var resource = client.resources.pages.pageId(page_id);
```

##### GET

Retrieve a single page.

```js
resource.get().then(function (res) { ... });
```

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.pages.pageId(page_id).formFields

Form Fields specifically refers to the forms you can add to Unbounce landing pages in the Unbounce page editor.

```js
var resource = client.resources.pages.pageId(page_id).formFields;
```

##### GET

Retrieve a full list of all form fields across all page variants of a specific page.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **include_sub_pages** _boolean_

When true, include sub page form fields in the response

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.pages.pageId(page_id).leads

The leads collection provides access to all of the submitted leads associated with a specific page.

```js
var resource = client.resources.pages.pageId(page_id).leads;
```

##### GET

Retrieve a list of all leads for a given page.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

##### POST

Create a new lead.
New leads created via the API are marked distinctly from those created through the webapp.
Leads created via the API will have a new attribute in their **extra_data** field:

    { 'created_by': 'api' }

```js
resource.post().then(function (res) { ... });
```

##### Body

**application/vnd.unbounce.api.v0.4+json**

```
{
  "$schema" : "http://json-schema.org/draft-04/schema#",
  "description" : "Representation of a new lead",
  "type" : "object",
  "additionalProperties" : false,
  "required" : [ "form_submission" ],
  "properties" : {
    "conversion" : {
      "description" : "Whether this lead should be marked as having converted or not.",
      "type" : "boolean"
    },
    "form_submission" : {
      "type" : "object",
      "additionalProperties" : false,
      "required" : [ "variant_id", "submitter_ip", "form_data" ],
      "properties" : {
        "variant_id" : {
          "description" : "The published page variant Id.",
          "type" : "string"
        },
        "submitter_ip" : {
          "description" : "Originating IP address of the lead.",
          "type" : "string"
        },
        "form_data" : {
          "description" : "Form fields and form values representing a lead.",
          "type" : "object"
        }
      }
    },
    "visitor_id" : {
      "description" : "Unbounce's internal visitor ID for tracking the lead.",
      "type" : "string"
    }
  },
  "id" : "https://api.unbounce.com/raml/v0.4/schema/new_lead.json"
}
```

#### resources.pageGroups.pageGroupId(page_group_id).pages

Pages may optionally be organized into groups.
Each page group provides a link to the pages it contains in its meta data collection.

```js
var resource = client.resources.pageGroups.pageGroupId(page_group_id).pages;
```

##### GET

Retrieve a list of all pages that belong to a given page group.

```js
resource.get().then(function (res) { ... });
```

##### Query Parameters

```javascript
resource.get({ ... });
```

* **sort_order** _string, one of (asc, desc), default: asc_

Sort by creation date.

* **count** _boolean_

When true, don't return the response's collection attribute.

* **from** _string_

Limit results to those created after from.

* **to** _string_

Limit results to those created before to.

* **offset** _integer_

Omit the first offset number of results.

* **limit** _integer, default: 50_

Only return limit number of results.

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.leads.leadId(lead_id)

* **lead_id** _string_

There are two sets of data associated with each lead;
the form data submitted when the lead was collected,
and any optional extra data provided by 3rd party integrations with Unbounce
(such as lead scoring or social data).
Fields within the form data collection use a normalized form of the form field name.

```js
var resource = client.resources.leads.leadId(lead_id);
```

##### GET

Retrieve a single lead.

```js
resource.get().then(function (res) { ... });
```

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.users.self

Data for the currently authenticated user.
Note that using an API Key does not authenticate as a user.

```js
var resource = client.resources.users.self;
```

##### GET

Retrieve the current user.

```js
resource.get().then(function (res) { ... });
```

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_

#### resources.users.userId(user_id)

* **user_id** _string_

User data.

```js
var resource = client.resources.users.userId(user_id);
```

##### GET

Retrieves a particular user.

```js
resource.get().then(function (res) { ... });
```

##### Headers

```javascript
resource.get(null, {
  headers: { ... }
});
```

* **Accept** _string, one of (application/vnd.unbounce.api.v0.4+json), default: application/vnd.unbounce.api.v0.4+json_



### Custom Resources

You can make requests to a custom path in the API using the `#resource(path)` method.

```javascript
client.resource('/example/path').get();
```

## License

Apache 2.0
